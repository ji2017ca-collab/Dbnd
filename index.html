<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <title>Cubo 3D con TransformControls y Three.js</title>
    <style>
        body { margin: 0; overflow: hidden; background-color: #f0f0f0; }
        canvas { display: block; }
    </style>
</head>
<body>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/three.js/r128/three.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/three@0.128.0/examples/js/controls/OrbitControls.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/three@0.128.0/examples/js/controls/TransformControls.js"></script>

    <script>
        // --- 1. CONFIGURACIÓN BÁSICA ---
        let scene, camera, renderer;
        let controls, transformControls;
        let cube;
        const size = 1; // Tamaño del cubo

        function init() {
            // 1.1. Escena
            scene = new THREE.Scene();
            scene.background = new THREE.Color(0x333333); // Fondo gris oscuro

            // 1.2. Cámara 3D
            camera = new THREE.PerspectiveCamera(75, window.innerWidth / window.innerHeight, 0.1, 1000);
            camera.position.set(3, 3, 3); // Posición inicial de la cámara

            // 1.3. Renderer
            renderer = new THREE.WebGLRenderer({ antialias: true });
            renderer.setSize(window.innerWidth, window.innerHeight);
            document.body.appendChild(renderer.domElement);

            // --- 2. ELEMENTOS 3D ---
            
            // 2.1. El Cubo (Geometría, Material y Malla)
            const geometry = new THREE.BoxGeometry(size, size, size);
            
            // Materiales de las 6 caras (diferentes colores)
            const materials = [
                new THREE.MeshBasicMaterial({ color: 0xff0000, opacity: 0.8, transparent: true }), // Rojo (Derecha)
                new THREE.MeshBasicMaterial({ color: 0x00ff00, opacity: 0.8, transparent: true }), // Verde (Izquierda)
                new THREE.MeshBasicMaterial({ color: 0x0000ff, opacity: 0.8, transparent: true }), // Azul (Arriba)
                new THREE.MeshBasicMaterial({ color: 0xffff00, opacity: 0.8, transparent: true }), // Amarillo (Abajo)
                new THREE.MeshBasicMaterial({ color: 0xff00ff, opacity: 0.8, transparent: true }), // Magenta (Frente)
                new THREE.MeshBasicMaterial({ color: 0x00ffff, opacity: 0.8, transparent: true })  // Cyan (Atrás)
            ];
            
            cube = new THREE.Mesh(geometry, materials);
            scene.add(cube);

            // 2.2. Rejilla (GridHelper)
            const gridHelper = new THREE.GridHelper(10, 10, 0xaaaaaa, 0x555555); // Tamaño 10x10
            scene.add(gridHelper);

            // 2.3. Iluminación (Opcional, pero recomendado)
            const ambientLight = new THREE.AmbientLight(0x404040, 5); // Luz suave
            scene.add(ambientLight);
            
            const directionalLight = new THREE.DirectionalLight(0xffffff, 1);
            directionalLight.position.set(5, 5, 5);
            scene.add(directionalLight);

            // --- 3. CONTROLES DE INTERACCIÓN ---

            // 3.1. OrbitControls (Rotar la CÁMARA 3D)
            controls = new THREE.OrbitControls(camera, renderer.domElement);
            controls.enableDamping = true; // Efecto de inercia suave
            controls.dampingFactor = 0.05;

            // 3.2. TransformControls (Mover, Rotar, Escalar el CUBO)
            transformControls = new THREE.TransformControls(camera, renderer.domElement);
            transformControls.attach(cube); // Adjuntar los controles al objeto cubo
            scene.add(transformControls);

            // Deshabilitar OrbitControls mientras se usa TransformControls
            transformControls.addEventListener('dragging-changed', function (event) {
                controls.enabled = !event.value;
            });
            
            // --- 4. MANEJO DE TECLAS PARA CAMBIAR EL MODO DE TRANSFORMACIÓN ---
            window.addEventListener('keydown', function (event) {
                switch (event.key) {
                    case 't': // T para Trasladar (Mover)
                        transformControls.setMode('translate');
                        break;
                    case 'r': // R para Rotar
                        transformControls.setMode('rotate');
                        break;
                    case 's': // S para Escalar
                        transformControls.setMode('scale');
                        break;
                }
            });
            
            // Manejar redimensionamiento de ventana
            window.addEventListener('resize', onWindowResize, false);
        }

        function onWindowResize() {
            camera.aspect = window.innerWidth / window.innerHeight;
            camera.updateProjectionMatrix();
            renderer.setSize(window.innerWidth, window.innerHeight);
        }

        // --- 5. BUCLE DE ANIMACIÓN ---
        function animate() {
            requestAnimationFrame(animate);

            controls.update(); // Necesario para OrbitControls
            renderer.render(scene, camera);
        }

        init();
        animate();
    </script>
</body>
</html>
